<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥ ì‹¤ì œ PT ì¶”ì  ë§¤íŠ¸ë¦­ìŠ¤ (2025.06~09)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            margin: 0 0 5px 0;
            font-size: 22px;
        }

        .header .subtitle {
            margin: 0 0 10px 0;
            font-size: 13px;
            opacity: 0.9;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 15px;
            font-size: 11px;
        }

        .controls {
            background: white;
            padding: 8px 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filter-input {
            padding: 4px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            width: 150px;
        }

        .container {
            height: calc(100vh - 120px);
            display: flex;
            overflow: hidden;
        }

        /* í™˜ìëª… ê³ ì • ì—´ */
        .patient-column {
            width: 120px;
            background: white;
            border-right: 2px solid #ddd;
            overflow-y: auto;
            z-index: 10;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
        }

        .patient-header {
            height: 40px;
            background: #343a40;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 11px;
            position: sticky;
            top: 0;
            z-index: 15;
        }

        .patient-cell {
            height: 35px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            font-size: 10px;
            font-weight: 600;
            color: #495057;
            cursor: pointer;
        }

        .patient-cell:hover {
            background: #f8f9fa;
        }

        /* ë°ì´í„° ìŠ¤í¬ë¡¤ ì˜ì—­ */
        .data-scroll {
            flex: 1;
            overflow: auto;
        }

        .data-grid {
            display: inline-block;
            min-width: fit-content;
        }

        /* ë‚ ì§œ í—¤ë” */
        .date-header {
            display: flex;
            height: 40px;
            position: sticky;
            top: 0;
            z-index: 5;
            background: white;
            border-bottom: 2px solid #ddd;
        }

        .date-cell {
            width: 80px;
            min-width: 80px;
            border-right: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            font-weight: bold;
            font-size: 10px;
            color: #495057;
        }

        .date-cell:hover {
            background: #e9ecef;
        }

        /* í™˜ìë³„ ë°ì´í„° í–‰ */
        .patient-row {
            display: flex;
            height: 35px;
            border-bottom: 1px solid #e9ecef;
        }

        .treatment-cell {
            width: 80px;
            min-width: 80px;
            border-right: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            cursor: pointer;
            position: relative;
        }

        .treatment-cell:hover {
            transform: scale(1.05);
            z-index: 3;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .treatment-cell.empty {
            background: #ffffff;
        }

        .treatment-cell.empty:hover {
            background: #f8f9fa;
        }

        /* ì¹˜ë£Œì‚¬ë³„ ìƒ‰ê¹” */
        .ì‹ í™˜ { background: #ffe5e5; color: #c92a2a; font-weight: bold; }
        .ê°•ìˆ˜ì§€ { background: #e5f3ff; color: #1971c2; font-weight: bold; }
        .ê¹€ë¯¼ì„  { background: #e5ffe5; color: #2f9e44; font-weight: bold; }
        .ì–‘ì§€ì˜ { background: #fff5e5; color: #e8590c; font-weight: bold; }
        .ì•ˆì§„ê²½ { background: #f3e5ff; color: #7950f2; font-weight: bold; }
        .ë¹„ê³  { background: #e5ffff; color: #0ca678; font-weight: bold; }

        .first-visit::after {
            content: " â­";
            color: #ffc107;
            font-size: 10px;
        }

        .treatment-text {
            text-align: center;
            line-height: 1.1;
        }

        /* ë²”ë¡€ */
        .legend {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: white;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .legend div {
            margin: 1px 0;
            padding: 1px 6px;
            border-radius: 2px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            font-size: 16px;
            color: #666;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .patient-column { width: 80px; }
            .date-cell, .treatment-cell { width: 60px; min-width: 60px; }
            .filter-input { width: 100px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¥ ì‹¤ì œ PT ì¶”ì  ë§¤íŠ¸ë¦­ìŠ¤</h1>
        <p class="subtitle">2025ë…„ 6ì›”~9ì›” ì‹¤ì œ ì˜ˆì•½ ë°ì´í„° â€¢ ê°€ë¡œ ë¬´í•œ ìŠ¤í¬ë¡¤</p>
        <div class="stats">
            <span id="patientCount">í™˜ì: 50ëª…</span>
            <span id="dateRange">ê¸°ê°„: 06/01~09/30</span>
            <span id="treatmentCount">ì¹˜ë£Œ: ê³„ì‚°ì¤‘...</span>
            <span id="firstVisitCount">ì²«ë‚´ì›: ê³„ì‚°ì¤‘...</span>
        </div>
    </div>

    <div class="controls">
        <div>
            <input type="text" id="patientFilter" class="filter-input" placeholder="í™˜ìëª… ê²€ìƒ‰..." onkeyup="filterPatients()">
        </div>
        <div>
            <label>
                <input type="checkbox" id="firstVisitOnly" onchange="filterPatients()"> ì²«ë‚´ì›ë§Œ ë³´ê¸°
            </label>
            <span style="margin-left: 15px; font-size: 11px; color: #666;">
                ì¢Œìš° í™”ì‚´í‘œ: ìŠ¤í¬ë¡¤ | Shift+íœ : ê°€ë¡œìŠ¤í¬ë¡¤
            </span>
        </div>
    </div>

    <div class="container">
        <!-- í™˜ìëª… ê³ ì • ì—´ -->
        <div class="patient-column">
            <div class="patient-header">í™˜ìëª…</div>
            <div id="patient-list">
                <!-- JavaScriptë¡œ ìƒì„± -->
            </div>
        </div>

        <!-- ë°ì´í„° ìŠ¤í¬ë¡¤ ì˜ì—­ -->
        <div class="data-scroll" id="dataScroll">
            <div class="data-grid">
                <!-- ë‚ ì§œ í—¤ë” -->
                <div class="date-header" id="dateHeader">
                    <!-- JavaScriptë¡œ ìƒì„± -->
                </div>

                <!-- í™˜ìë³„ ë°ì´í„° í–‰ë“¤ -->
                <div id="patientRows">
                    <!-- JavaScriptë¡œ ìƒì„± -->
                </div>
            </div>
        </div>
    </div>

    <!-- ì¹˜ë£Œì‚¬ë³„ ìƒ‰ê¹” ë²”ë¡€ -->
    <div class="legend">
        <div><strong>ğŸ‘©â€âš•ï¸ ì¹˜ë£Œì‚¬</strong></div>
        <div class="ì‹ í™˜">ì‹ í™˜</div>
        <div class="ê°•ìˆ˜ì§€">ê°•ìˆ˜ì§€</div>
        <div class="ê¹€ë¯¼ì„ ">ê¹€ë¯¼ì„ </div>
        <div class="ì–‘ì§€ì˜">ì–‘ì§€ì˜</div>
        <div class="ì•ˆì§„ê²½">ì•ˆì§„ê²½</div>
        <div class="ë¹„ê³ ">ë¹„ê³ </div>
        <div style="margin-top: 5px; color: #666;">â­ = ì²«ë‚´ì›</div>
    </div>

    <script>
        // ì‹¤ì œ ì—‘ì…€ ë°ì´í„° (JSON ì˜ì¡´ì„± ì œê±°)
        const ptData = {
  "patients": [
    "ê°€ëŠ¥í•˜ë©´",
    "ê°•ë³‘í˜¸",
    "ê°•ì°½ì„",
    "ê°•ì°½ì„ì¹˜ë£Œì‚¬",
    "ê°•ì°½ì„ì¹˜ë£Œì‚¬í™˜ì",
    "ê±´ê°•ê²€ì§„í›„",
    "ê²½ê³¼ê¸°ë¡ì§€",
    "ê³ ìŠ¹ì™„",
    "ê³ ì£¼íŒŒ",
    "ê³ ì£¼íŒŒë°ëª¨",
    "ê³ ì£¼íŒŒë§Œ",
    "ê³ ì£¼íŒŒë§Œë¨¼ì €",
    "ê³ ì£¼íŒŒë¨¼ì €",
    "ê³ ì£¼íŒŒì—´ì¹˜ë£Œ",
    "ê³µì¸ì¸ì¦ì„œ",
    "ê³½ë™ìš°",
    "êµ¬í˜„ì •B",
    "ê¶Œì˜ì¤€",
    "ê¶Œì˜ì¤€C",
    "ê¶Œìœ¤êµ¬",
    "ê¸ˆìš”ì¼",
    "ê¸ˆì¼ë§Œ",
    "ê¹€ë‚˜í˜„C",
    "ê¹€ë‚¨ìˆ˜",
    "ê¹€ë•í¬",
    "ê¹€ë„ì›",
    "ê¹€ë¯¼ì„ ",
    "ê¹€ë¯¼ìˆœ",
    "ê¹€ë°¥ì£¼ë¬¸",
    "ê¹€ë³´ë¯¼",
    "ê¹€ì„±ê²½",
    "ê¹€ì†Œì •",
    "ê¹€ìˆ˜ê²½",
    "ê¹€ìŠ¹ë¯¼C",
    "ê¹€ì˜ì§„",
    "ê¹€ì˜ˆë¦°",
    "ê¹€ìš”í•œC",
    "ê¹€ìœ¤ê²¸",
    "ê¹€ìœ¤ì •",
    "ê¹€ì˜ì£¼",
    "ê¹€ì¸íƒœ",
    "ê¹€ì¥ìˆ˜",
    "ê¹€ì¥í—Œ",
    "ê¹€ì¬ìš°",
    "ê¹€ì¬í˜„",
    "ê¹€ì¢…ìµë‹˜",
    "ê¹€ì¤€í˜¸",
    "ê¹€ì§€ì˜",
    "ê¹€ì§€ì™„",
    "ê¹€íƒœì„"
  ],
  "dates": [
    "06/01",
    "06/02",
    "06/03",
    "06/04",
    "06/05",
    "06/06",
    "06/07",
    "06/08",
    "06/09",
    "06/10",
    "06/11",
    "06/12",
    "06/13",
    "06/14",
    "06/15",
    "06/16",
    "06/17",
    "06/18",
    "06/19",
    "06/20",
    "06/21",
    "06/22",
    "06/23",
    "06/24",
    "06/25",
    "06/26",
    "06/27",
    "06/28",
    "06/30",
    "07/01",
    "07/02",
    "07/03",
    "07/04",
    "07/05",
    "07/06",
    "07/07",
    "07/08",
    "07/09",
    "07/10",
    "07/11",
    "07/12",
    "07/13",
    "07/14",
    "07/15",
    "07/16",
    "07/17",
    "07/18",
    "07/19",
    "07/20",
    "07/21",
    "07/22",
    "07/23",
    "07/24",
    "07/25",
    "07/26",
    "07/27",
    "07/28",
    "07/29",
    "07/30",
    "07/31",
    "08/01",
    "08/02",
    "08/03",
    "08/05",
    "08/06",
    "08/07",
    "08/08",
    "08/09",
    "08/10",
    "08/11",
    "08/12",
    "08/13",
    "08/14",
    "08/15",
    "08/16",
    "08/17",
    "08/18",
    "08/19",
    "08/20",
    "08/21",
    "08/22",
    "08/23",
    "08/24",
    "08/25",
    "08/26",
    "08/27",
    "08/28",
    "08/29",
    "08/30",
    "08/31",
    "09/01",
    "09/02",
    "09/03",
    "09/05",
    "09/06",
    "09/07",
    "09/08",
    "09/09",
    "09/10",
    "09/11",
    "09/12",
    "09/13",
    "09/14",
    "09/15",
    "09/16",
    "09/17",
    "09/18",
    "09/19",
    "09/20",
    "09/21",
    "09/22",
    "09/23",
    "09/24",
    "09/25",
    "09/26",
    "09/27",
    "09/28",
    "09/29",
    "09/30"
  ],
  "matrix": {
    "ê°€ëŠ¥í•˜ë©´": {
      "09/18": {
        "therapist": "ê°•ìˆ˜ì§€",
        "time": "14:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê°•ë³‘í˜¸": {
      "07/07": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "07/14": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/08": {
        "therapist": "ì‹ í™˜",
        "time": "12:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/16": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê°•ì°½ì„": {
      "06/11": {
        "therapist": "ì•ˆì§„ê²½",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê°•ì°½ì„ì¹˜ë£Œì‚¬": {
      "07/12": {
        "therapist": "ê°•ìˆ˜ì§€",
        "time": "13:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê°•ì°½ì„ì¹˜ë£Œì‚¬í™˜ì": {
      "07/11": {
        "therapist": "ê°•ìˆ˜ì§€",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "07/15": {
        "therapist": "ê¹€ë¯¼ì„ ",
        "time": "11:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/15": {
        "therapist": "ê°•ìˆ˜ì§€",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê±´ê°•ê²€ì§„í›„": {
      "07/21": {
        "therapist": "ê¹€ë¯¼ì„ ",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê²½ê³¼ê¸°ë¡ì§€": {
      "08/19": {
        "therapist": "ì–‘ì§€ì˜",
        "time": "15:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ìŠ¹ì™„": {
      "06/12": {
        "therapist": "ì‹ í™˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ì£¼íŒŒ": {
      "06/14": {
        "therapist": "ì–‘ì§€ì˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "07/31": {
        "therapist": "ê°•ìˆ˜ì§€",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/13": {
        "therapist": "ì–‘ì§€ì˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/13": {
        "therapist": "ì–‘ì§€ì˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ì£¼íŒŒë°ëª¨": {
      "07/28": {
        "therapist": "ì•ˆì§„ê²½",
        "time": "15:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ì£¼íŒŒë§Œ": {
      "07/25": {
        "therapist": "ì•ˆì§„ê²½",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ì£¼íŒŒë§Œë¨¼ì €": {
      "07/28": {
        "therapist": "ì•ˆì§„ê²½",
        "time": "13:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ì£¼íŒŒë¨¼ì €": {
      "08/27": {
        "therapist": "ì–‘ì§€ì˜",
        "time": "13:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³ ì£¼íŒŒì—´ì¹˜ë£Œ": {
      "09/05": {
        "therapist": "ê¹€ë¯¼ì„ ",
        "time": "11:45:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê³µì¸ì¸ì¦ì„œ": {
      "06/18": {
        "therapist": "ë¹„ê³ ",
        "time": "10:30:00",
        "treatment": "7/17",
        "isFirst": false
      }
    },
    "ê³½ë™ìš°": {
      "06/11": {
        "therapist": "ì‹ í™˜",
        "time": "13:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "êµ¬í˜„ì •B": {
      "09/06": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¶Œì˜ì¤€": {
      "07/11": {
        "therapist": "ì‹ í™˜",
        "time": "11:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¶Œì˜ì¤€C": {
      "07/17": {
        "therapist": "ì‹ í™˜",
        "time": "12:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/06": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/07": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/08": {
        "therapist": "ì‹ í™˜",
        "time": "11:45:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/11": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/12": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/14": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/18": {
        "therapist": "ì‹ í™˜",
        "time": "10:45:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/27": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/29": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/01": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/02": {
        "therapist": "ì‹ í™˜",
        "time": "13:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/05": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/08": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/09": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/11": {
        "therapist": "ì‹ í™˜",
        "time": "13:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/12": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¶Œìœ¤êµ¬": {
      "06/07": {
        "therapist": "ì‹ í™˜",
        "time": "10:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/10": {
        "therapist": "ì‹ í™˜",
        "time": "10:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¸ˆìš”ì¼": {
      "08/19": {
        "therapist": "ê¹€ë¯¼ì„ ",
        "time": "14:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¸ˆì¼ë§Œ": {
      "09/16": {
        "therapist": "ì–‘ì§€ì˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë‚˜í˜„C": {
      "08/23": {
        "therapist": "ì‹ í™˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë‚¨ìˆ˜": {
      "08/24": {
        "therapist": "..",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/25": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë•í¬": {
      "07/10": {
        "therapist": "ì‹ í™˜",
        "time": "11:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë„ì›": {
      "08/16": {
        "therapist": "ì‹ í™˜",
        "time": "13:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë¯¼ì„ ": {
      "06/14": {
        "therapist": "ë¹„ê³ ",
        "time": "10:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë¯¼ìˆœ": {
      "08/08": {
        "therapist": "ì‹ í™˜",
        "time": "15:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë°¥ì£¼ë¬¸": {
      "06/12": {
        "therapist": "ë¹„ê³ ",
        "time": "10:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "06/20": {
        "therapist": "ë¹„ê³ ",
        "time": "10:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ë³´ë¯¼": {
      "09/17": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì„±ê²½": {
      "06/06": {
        "therapist": "ë¹„ê³ ",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì†Œì •": {
      "06/09": {
        "therapist": "ë¹„ê³ ",
        "time": "15:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/15": {
        "therapist": "ì‹ í™˜",
        "time": "13:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ìˆ˜ê²½": {
      "06/28": {
        "therapist": "ë¹„ê³ ",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ìŠ¹ë¯¼C": {
      "07/11": {
        "therapist": "ì‹ í™˜",
        "time": "11:45:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "07/15": {
        "therapist": "ì‹ í™˜",
        "time": "11:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/12": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì˜ì§„": {
      "08/07": {
        "therapist": "ì‹ í™˜",
        "time": "14:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì˜ˆë¦°": {
      "07/24": {
        "therapist": "ì‹ í™˜",
        "time": "15:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ìš”í•œC": {
      "06/06": {
        "therapist": "ì‹ í™˜",
        "time": "14:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ìœ¤ê²¸": {
      "08/07": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ìœ¤ì •": {
      "07/22": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "09/17": {
        "therapist": "ì‹ í™˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì˜ì£¼": {
      "06/30": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¸íƒœ": {
      "07/17": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "08/02": {
        "therapist": "ì‹ í™˜",
        "time": "13:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¥ìˆ˜": {
      "07/29": {
        "therapist": "ì‹ í™˜",
        "time": "14:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      },
      "07/30": {
        "therapist": "ì‹ í™˜",
        "time": "15:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¥í—Œ": {
      "08/11": {
        "therapist": "ì‹ í™˜",
        "time": "11:45:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¬ìš°": {
      "08/08": {
        "therapist": "ì‹ í™˜",
        "time": "12:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¬í˜„": {
      "08/09": {
        "therapist": "ì‹ í™˜",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¢…ìµë‹˜": {
      "06/10": {
        "therapist": "ë¹„ê³ ",
        "time": "10:30:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì¤€í˜¸": {
      "07/05": {
        "therapist": "ì‹ í™˜",
        "time": "13:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì§€ì˜": {
      "07/29": {
        "therapist": "ì‹ í™˜",
        "time": "10:15:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€ì§€ì™„": {
      "09/16": {
        "therapist": "ì‹ í™˜",
        "time": "10:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    },
    "ê¹€íƒœì„": {
      "09/15": {
        "therapist": "ì‹ í™˜",
        "time": "12:00:00",
        "treatment": "ì¹˜ë£Œ",
        "isFirst": false
      }
    }
  }
};

        let filteredData = null;

        // í†µê³„ ê³„ì‚°
        function calculateStats() {
            let treatmentCount = 0;
            let firstVisitCount = 0;

            for (const patient in ptData.matrix) {
                for (const date in ptData.matrix[patient]) {
                    treatmentCount++;
                    if (ptData.matrix[patient][date].isFirst) {
                        firstVisitCount++;
                    }
                }
            }

            document.getElementById('treatmentCount').textContent = `ì¹˜ë£Œ: ${treatmentCount}ê±´`;
            document.getElementById('firstVisitCount').textContent = `ì²«ë‚´ì›: ${firstVisitCount}ê±´`;
        }

        // ì¹˜ë£Œì‚¬ í´ë˜ìŠ¤ëª… ì •ê·œí™”
        function getTherapistClass(therapistName) {
            const normalized = therapistName.trim();
            const validClasses = ['ì‹ í™˜', 'ê°•ìˆ˜ì§€', 'ê¹€ë¯¼ì„ ', 'ì–‘ì§€ì˜', 'ì•ˆì§„ê²½', 'ë¹„ê³ '];

            for (const cls of validClasses) {
                if (normalized.includes(cls)) {
                    return cls;
                }
            }
            return 'default';
        }

        // í…Œì´ë¸” ìƒì„±
        function createTable() {
            const currentData = filteredData || ptData;

            // í™˜ì ëª©ë¡ ë Œë”ë§
            const patientList = document.getElementById('patient-list');
            patientList.innerHTML = currentData.patients.map(patient => `
                <div class="patient-cell" onclick="highlightPatient('${patient}')">${patient}</div>
            `).join('');

            // ë‚ ì§œ í—¤ë” ë Œë”ë§
            const dateHeader = document.getElementById('dateHeader');
            dateHeader.innerHTML = currentData.dates.map(date => `
                <div class="date-cell">${date}</div>
            `).join('');

            // í™˜ìë³„ ë°ì´í„° í–‰ ë Œë”ë§
            const patientRows = document.getElementById('patientRows');
            patientRows.innerHTML = currentData.patients.map(patient => {
                const rowCells = currentData.dates.map(date => {
                    const treatment = ptData.matrix[patient] && ptData.matrix[patient][date];
                    if (treatment) {
                        const therapistClass = getTherapistClass(treatment.therapist);
                        const firstClass = treatment.isFirst ? 'first-visit' : '';

                        return `
                            <div class="treatment-cell ${therapistClass} ${firstClass}"
                                 title="${patient}\\n${date} ${treatment.time}\\n${treatment.therapist}\\n${treatment.treatment}">
                                <div class="treatment-text">${treatment.treatment}</div>
                            </div>
                        `;
                    } else {
                        return `<div class="treatment-cell empty"></div>`;
                    }
                }).join('');

                return `<div class="patient-row">${rowCells}</div>`;
            }).join('');
        }

        // í™˜ì ê²€ìƒ‰ ë° í•„í„°
        function filterPatients() {
            const searchTerm = document.getElementById('patientFilter').value.toLowerCase();
            const firstVisitOnly = document.getElementById('firstVisitOnly').checked;

            if (!searchTerm && !firstVisitOnly) {
                filteredData = null;
                createTable();
                return;
            }

            let filteredPatients = ptData.patients;

            // ì´ë¦„ í•„í„°
            if (searchTerm) {
                filteredPatients = filteredPatients.filter(patient =>
                    patient.toLowerCase().includes(searchTerm)
                );
            }

            // ì²«ë‚´ì› í•„í„°
            if (firstVisitOnly) {
                filteredPatients = filteredPatients.filter(patient => {
                    const visits = ptData.matrix[patient] || {};
                    return Object.values(visits).some(visit => visit.isFirst);
                });
            }

            filteredData = {
                patients: filteredPatients,
                dates: ptData.dates
            };

            createTable();
        }

        // í™˜ì í•˜ì´ë¼ì´íŠ¸
        function highlightPatient(patientName) {
            // ëª¨ë“  í•˜ì´ë¼ì´íŠ¸ ì œê±°
            document.querySelectorAll('.patient-cell').forEach(cell => {
                cell.style.backgroundColor = '';
            });
            document.querySelectorAll('.patient-row').forEach(row => {
                row.style.backgroundColor = '';
            });

            // ì„ íƒëœ í™˜ì í•˜ì´ë¼ì´íŠ¸
            const cells = document.querySelectorAll('.patient-cell');
            const rows = document.querySelectorAll('.patient-row');

            cells.forEach((cell, index) => {
                if (cell.textContent === patientName) {
                    cell.style.backgroundColor = '#fffacd';
                    if (rows[index]) {
                        rows[index].style.backgroundColor = '#fffacd';
                    }
                }
            });
        }

        // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        document.addEventListener('keydown', function(e) {
            const scrollAmount = 160; // 2ì…€ ë¶„ëŸ‰
            const dataScroll = document.getElementById('dataScroll');

            switch(e.key) {
                case 'ArrowLeft':
                    dataScroll.scrollLeft -= scrollAmount;
                    e.preventDefault();
                    break;
                case 'ArrowRight':
                    dataScroll.scrollLeft += scrollAmount;
                    e.preventDefault();
                    break;
                case 'Home':
                    dataScroll.scrollLeft = 0;
                    e.preventDefault();
                    break;
                case 'End':
                    dataScroll.scrollLeft = dataScroll.scrollWidth;
                    e.preventDefault();
                    break;
            }
        });

        // ë§ˆìš°ìŠ¤ íœ  ê°€ë¡œ ìŠ¤í¬ë¡¤
        document.getElementById('dataScroll').addEventListener('wheel', function(e) {
            if (e.shiftKey) {
                e.preventDefault();
                this.scrollLeft += e.deltaY;
            }
        });

        // ì´ˆê¸°í™”
        calculateStats();
        createTable();

        console.log('âœ… ì‹¤ì œ PT ë§¤íŠ¸ë¦­ìŠ¤ ë¡œë”© ì™„ë£Œ!');
        console.log(`ğŸ“Š í™˜ì ${ptData.patients.length}ëª…, ë‚ ì§œ ${ptData.dates.length}ì¼`);
        console.log('ğŸ® ì‚¬ìš©ë²•: ì¢Œìš° í™”ì‚´í‘œë¡œ ìŠ¤í¬ë¡¤, Shift+íœ ë¡œ ê°€ë¡œìŠ¤í¬ë¡¤, í™˜ìëª… í´ë¦­ìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸');
    </script>
</body>
</html>