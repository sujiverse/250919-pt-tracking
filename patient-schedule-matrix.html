<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“‹ í™˜ìë³„ ì¹˜ë£Œ ìŠ¤ì¼€ì¤„ ë§¤íŠ¸ë¦­ìŠ¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            font-size: 14px;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-number {
            font-size: 20px;
            font-weight: bold;
        }

        .controls {
            background: white;
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .filter-select, .filter-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .container {
            height: calc(100vh - 140px);
            position: relative;
            overflow: hidden;
            background: white;
        }

        /* ê³ ì • í—¤ë” ì˜ì—­ */
        .patient-header {
            position: absolute;
            top: 0;
            left: 0;
            width: 180px;
            height: 60px;
            background: #495057;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            z-index: 20;
            border-right: 2px solid #333;
            border-bottom: 2px solid #333;
        }

        /* ë‚ ì§œ í—¤ë” (ê°€ë¡œ ìŠ¤í¬ë¡¤) */
        .date-header {
            position: absolute;
            top: 0;
            left: 180px;
            right: 0;
            height: 60px;
            background: #e9ecef;
            border-bottom: 2px solid #333;
            overflow-x: auto;
            overflow-y: hidden;
            z-index: 15;
        }

        .date-row {
            display: flex;
            height: 60px;
            min-width: fit-content;
        }

        .date-cell {
            width: 120px;
            min-width: 120px;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #e9ecef;
            font-weight: bold;
            font-size: 11px;
            padding: 5px;
        }

        .date-main {
            font-size: 12px;
            font-weight: bold;
            color: #333;
        }

        .date-sub {
            font-size: 10px;
            color: #666;
            margin-top: 2px;
        }

        /* í™˜ì ëª©ë¡ (ì„¸ë¡œ ìŠ¤í¬ë¡¤) */
        .patient-list {
            position: absolute;
            top: 60px;
            left: 0;
            width: 180px;
            bottom: 0;
            background: #f8f9fa;
            border-right: 2px solid #333;
            overflow-x: hidden;
            overflow-y: auto;
            z-index: 15;
        }

        .patient-cell {
            height: 50px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 12px;
            background: #f8f9fa;
            font-size: 13px;
            font-weight: 600;
            color: #495057;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .patient-cell:hover {
            background: #e9ecef;
        }

        .patient-cell.new-patient {
            border-left: 4px solid #28a745;
            background: #f8fff9;
        }

        .patient-cell.frequent-patient {
            border-left: 4px solid #ffc107;
            background: #fffcf5;
        }

        .patient-name {
            flex: 1;
        }

        .first-visit {
            font-size: 9px;
            color: #28a745;
            margin-left: 5px;
        }

        /* ë°ì´í„° ì˜ì—­ (ìŠ¤í¬ë¡¤ ê°€ëŠ¥) */
        .data-area {
            position: absolute;
            top: 60px;
            left: 180px;
            right: 0;
            bottom: 0;
            overflow: auto;
            z-index: 10;
        }

        .data-grid {
            min-width: fit-content;
        }

        .data-row {
            display: flex;
            height: 50px;
            border-bottom: 1px solid #ddd;
        }

        .data-cell {
            width: 120px;
            min-width: 120px;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            position: relative;
            padding: 4px;
            background: white;
            transition: all 0.2s;
        }

        .data-cell:hover {
            background: #f8f9fa;
            transform: scale(1.02);
            z-index: 5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .data-cell.has-appointment {
            background: #e3f2fd;
            border: 1px solid #2196f3;
        }

        .data-cell.new-patient-visit {
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }

        .data-cell.cancelled {
            background: #ffebee;
            border: 1px solid #f44336;
            opacity: 0.7;
        }

        .data-cell.deferred {
            background: #fff3e0;
            border: 1px solid #ff9800;
            opacity: 0.8;
        }

        .appointment-time {
            font-weight: bold;
            font-size: 11px;
            color: #333;
        }

        .appointment-course {
            font-size: 9px;
            color: #666;
            margin-top: 2px;
        }

        .appointment-session {
            font-size: 8px;
            color: #999;
        }

        /* ì½”ìŠ¤ë³„ ìƒ‰ìƒ */
        .course-A { border-left: 4px solid #e91e63; }
        .course-B { border-left: 4px solid #2196f3; }
        .course-C { border-left: 4px solid #4caf50; }
        .course-D { border-left: 4px solid #ff9800; }
        .course-H { border-left: 4px solid #9c27b0; }

        .status-badge {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 7px;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
        }

        .status-cancel {
            background: #f44336;
            color: white;
        }

        .status-defer {
            background: #ff9800;
            color: white;
        }

        .new-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 7px;
            background: #4caf50;
            color: white;
            padding: 1px 2px;
            border-radius: 2px;
        }

        /* ë²”ë¡€ */
        .legend {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 11px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-height: 400px;
            overflow-y: auto;
            width: 220px;
        }

        .legend h4 {
            margin: 0 0 8px 0;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 4px 0;
        }

        .legend-color {
            width: 16px;
            height: 12px;
            margin-right: 8px;
            border-radius: 2px;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        .date-header::-webkit-scrollbar,
        .data-area::-webkit-scrollbar,
        .patient-list::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .date-header::-webkit-scrollbar-track,
        .data-area::-webkit-scrollbar-track,
        .patient-list::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .date-header::-webkit-scrollbar-thumb,
        .data-area::-webkit-scrollbar-thumb,
        .patient-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .date-header::-webkit-scrollbar-thumb:hover,
        .data-area::-webkit-scrollbar-thumb:hover,
        .patient-list::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .patient-header, .patient-list { width: 120px; }
            .date-header, .data-area { left: 120px; }
            .date-cell, .data-cell { width: 100px; min-width: 100px; }
            .controls { flex-direction: column; }
            .legend { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“‹ í™˜ìë³„ ì¹˜ë£Œ ìŠ¤ì¼€ì¤„ ë§¤íŠ¸ë¦­ìŠ¤</h1>
        <p>ê°€ë¡œ ë¬´í•œ ìŠ¤í¬ë¡¤ â€¢ ì›”ë³„ í•„í„° â€¢ ì‹ í™˜ ì¶”ì </p>
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalPatients">0</div>
                <div>ì´ í™˜ì</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalAppointments">0</div>
                <div>ì´ ì˜ˆì•½</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="newPatients">0</div>
                <div>ì‹ í™˜</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="dateRange">-</div>
                <div>ê¸°ê°„</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <div class="filter-group">
            <label>ì›”ë³„ í•„í„°:</label>
            <select id="monthFilter" class="filter-select">
                <option value="">ì „ì²´ ì›”</option>
            </select>

            <label>í™˜ì ê²€ìƒ‰:</label>
            <input type="text" id="patientSearch" class="filter-input" placeholder="í™˜ìëª… ì…ë ¥...">

            <label>ì½”ìŠ¤ í•„í„°:</label>
            <select id="courseFilter" class="filter-select">
                <option value="">ì „ì²´ ì½”ìŠ¤</option>
                <option value="A">A ì½”ìŠ¤</option>
                <option value="B">B ì½”ìŠ¤</option>
                <option value="C">C ì½”ìŠ¤</option>
                <option value="D">D ì½”ìŠ¤</option>
                <option value="H">H ì½”ìŠ¤</option>
            </select>
        </div>

        <div class="filter-group">
            <label>
                <input type="checkbox" id="showNewOnly"> ì‹ í™˜ë§Œ ë³´ê¸°
            </label>
        </div>
    </div>

    <div class="container">
        <!-- ê³ ì • í—¤ë” (í™˜ìëª…) -->
        <div class="patient-header">
            <div>í™˜ìëª…</div>
        </div>

        <!-- ë‚ ì§œ í—¤ë” (ê°€ë¡œ ìŠ¤í¬ë¡¤) -->
        <div class="date-header" id="dateHeader">
            <div class="date-row" id="dateRow">
                <!-- JavaScriptë¡œ ìƒì„± -->
            </div>
        </div>

        <!-- í™˜ì ëª©ë¡ (ì„¸ë¡œ ìŠ¤í¬ë¡¤) -->
        <div class="patient-list" id="patientList">
            <!-- JavaScriptë¡œ ìƒì„± -->
        </div>

        <!-- ë°ì´í„° ì˜ì—­ (ì–‘ë°©í–¥ ìŠ¤í¬ë¡¤) -->
        <div class="data-area" id="dataArea">
            <div class="data-grid" id="dataGrid">
                <!-- JavaScriptë¡œ ìƒì„± -->
            </div>
        </div>
    </div>

    <!-- ë²”ë¡€ -->
    <div class="legend">
        <h4>ğŸ“Š í‘œì‹œ ë°©ë²•</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #e8f5e8; border: 1px solid #4caf50;"></div>
            ì‹ í™˜ (ì²« ë‚´ì›)
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #e3f2fd; border: 1px solid #2196f3;"></div>
            ì¼ë°˜ ì˜ˆì•½
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ffebee; border: 1px solid #f44336;"></div>
            ì·¨ì†Œëœ ì˜ˆì•½
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #fff3e0; border: 1px solid #ff9800;"></div>
            ë¯¸ë¤„ì§„ ì˜ˆì•½
        </div>

        <h4>ğŸ¨ ì½”ìŠ¤ë³„ ìƒ‰ìƒ</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #e91e63;"></div>
            A ì½”ìŠ¤
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #2196f3;"></div>
            B ì½”ìŠ¤
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #4caf50;"></div>
            C ì½”ìŠ¤
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ff9800;"></div>
            D ì½”ìŠ¤
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #9c27b0;"></div>
            H ì½”ìŠ¤
        </div>

        <h4>ğŸ‘¤ í™˜ì êµ¬ë¶„</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #f8fff9; border-left: 4px solid #28a745;"></div>
            ì‹ í™˜
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #fffcf5; border-left: 4px solid #ffc107;"></div>
            ë‹¤íšŒ ë°©ë¬¸ (3íšŒ+)
        </div>
    </div>

    <script>
        // ì›ë³¸ ë°ì´í„°ë¥¼ íŒŒì‹±í•˜ì—¬ êµ¬ì¡°í™”
        const rawData = `
@09/22/2025    10:30 í™˜ìDX C.5
@09/22/2025    11:00 í™˜ìSC C(D).4/10(4)
@09/22/2025    4:00 í™˜ìWB C(D).5/5(8)
@09/22/2025    5:30 í™˜ìGC
@09/22/2025    6:30 í™˜ìKC D(H).1/10(23)
@09/22/2025    7:30 í™˜ìB C.4/10(4)
@09/22/2025    12:00 í™˜ìRB D.
@09/20/2025    10:00 í™˜ìLB A.6
@09/19/2025    12:00 í™˜ìO A.25
@09/19/2025    4:00 í™˜ìWB C(D).5/5(8)
@09/19/2025    6:30 í™˜ìCB C.40
@09/18/2025    11:00 í™˜ìRB D3/10(4)
@09/18/2025    12:00 í™˜ìB C.5/10(5)
@09/18/2025    4:00 í™˜ìWB C(D).4/5(7)
@09/18/2025    4:40 í™˜ìNB A.6
@09/18/2025    5:30 í™˜ìQ D.6
@09/18/2025    7:00 í™˜ìF D.1
@09/15/2025    10:40 í™˜ìSC C(D).3/10(3)
@09/15/2025    12:00 í™˜ìVC C(D).1/10(17)
@09/15/2025    1:00 í™˜ìO A.24
@09/15/2025    4:00 í™˜ìWB C(D).3/5(6)
@09/15/2025    6:30 í™˜ìB C.4/10(4)
@09/15/2025    6:40 í™˜ìKC D(H).10/10(22)
@09/13/2025    9:00 í™˜ìH C.9/10(40)
@09/13/2025    10:00 í™˜ìKC D(H).9/10(21)
@09/13/2025    11:00 í™˜ìLB A.5
@09/13/2025    11:30 í™˜ìRB D.3
@09/13/2025    12:30 í™˜ìO A.23
@09/13/2025    1:00 í™˜ìCB C.38
@09/12/2025    11:30 í™˜ìH C.8/10(39)
@09/12/2025    4:10 í™˜ìRB D.2
@09/12/2025    6:00 í™˜ìO A.22
@09/12/2025    7:00 í™˜ìPD D.2
@09/11/2025    10:00 í™˜ìVC C.15
@09/11/2025    11:00 í™˜ìB C.3/10(3)
@09/11/2025    11:40 í™˜ìH C.7/10(38)
@09/11/2025    6:30 í™˜ìJ D.11
@09/11/2025    7:30 í™˜ìPD C.1
@09/08/2025    12:00 í™˜ìMB ì¶©ê²©íŒŒ15.1
@09/08/2025    6:00 í™˜ìB C.2/10(2)
@09/08/2025    7:20 í™˜ìIB C.1
@09/06/2025    10:00 í™˜ìA C.8/10(8)
@09/06/2025    1:00 í™˜ìVC D.13
@09/05/2025    10:00 í™˜ìDX C.4
@09/05/2025    11:30 í™˜ìB C.1/10(1)
@09/04/2025    2:00 í™˜ìRB D.1
@09/04/2025    3:00 í™˜ìWB C(D).2/5(5)
@09/04/2025    4:00 í™˜ìX D.30
@09/04/2025    4:30 í™˜ìJ D.V
@09/04/2025    7:00 í™˜ìT C.4
@09/01/2025    10:30 í™˜ìDX C.3
@09/01/2025    11:30 í™˜ìH C.6/10(37)
@09/01/2025    12:30 í™˜ìVC D.12
@09/01/2025    3:00 í™˜ìWB B(C).4
@09/01/2025    7:00 í™˜ìE B(C).6/10(7)
@09/01/2025    7:30 í™˜ìU D.41
@08/30/2025    10:00 í™˜ìLB A.4
@08/30/2025    10:00 í™˜ìH C.5/10(36)
@08/30/2025    11:00 í™˜ìKC D(H).7/10(19)
@08/30/2025    12:00 í™˜ì201 C(D).10/10(10)
@08/30/2025    1:00 í™˜ì202 D.4
@08/30/2025    2:30 í™˜ìVC D.11
@08/29/2025    10:30 í™˜ìDX C.2
@08/29/2025    12:00 í™˜ìVC D.10
@08/29/2025    4:35 í™˜ìNB A.5
@08/28/2025    12:30 í™˜ì203 D.5/7(8)
@08/28/2025    3:00 í™˜ìWB B(C).3
@08/28/2025    6:30 í™˜ìJ D.9/9(10)
@08/25/2025    10:00 í™˜ì201 C(D).9/10(9)
@08/25/2025    11:00 í™˜ìDX C(D).1
@08/25/2025    1:00 í™˜ì204B D(H).3/5(4)
@08/25/2025    3:00 í™˜ìWB A(B).2
@08/25/2025    7:00 í™˜ìE B(C).5/10(6)
@08/23/2025    9:00 í™˜ìH C.4/10(35)
@08/23/2025    10:00 í™˜ìLB A.3
@08/23/2025    12:00 í™˜ì202 D.3
@08/23/2025    14:00 í™˜ìVC D.10
@08/23/2025    2:20 í™˜ìKC D(H).6/10(18)
@08/22/2025    10:40 í™˜ìX D.29
@08/22/2025    12:00 í™˜ìH C.3/10(34)
@08/22/2025    2:00 í™˜ì232I C.1
@08/22/2025    4:40 í™˜ìC C.33
@08/22/2025    4:40 í™˜ìNB A.4
@08/22/2025    18:30 ì›ì¥ë‹˜ B(C)
@08/21/2025    10:30 í™˜ìVC D.8
@08/21/2025    11:30 í™˜ì201 C(D).8/10(8)
@08/21/2025    2:30 í™˜ìWB A(B).1
@08/21/2025    6:30 í™˜ìJ D.8/9(9)
@08/18/2025    11:20 í™˜ì201 C(D).7/10(7)
@08/18/2025    1:00 í™˜ìJ D.7/9(8)
@08/18/2025    1:50 í™˜ì204B D(H).2/5(3)
@08/18/2025    3:00 í™˜ìVC D.7
@08/18/2025    6:30 í™˜ì203 D.4/7(7)
@08/16/2025    12:00 í™˜ì202 D.2
@08/16/2025    1:00 í™˜ìVC D.6
@08/15/2025    10:00 í™˜ì202 D.1
@08/15/2025    11:10 í™˜ìVC D.5
@08/14/2025    9:30 í™˜ì205 C(D).2/5(3)
@08/14/2025    11:00 í™˜ì201 C(D).6/10(6)
@08/14/2025    12:00 í™˜ìH C.2/10(33)
@08/14/2025    2:00 í™˜ìVC D.4
@08/14/2025    3:00 í™˜ìU D.39
@08/14/2025    6:30 í™˜ì203 D.3/5(6)
@08/11/2025    12:00 í™˜ì204B D(H).1/5(2)
@08/11/2025    1:00 í™˜ì201 C(D).5/10(5)
@08/11/2025    3:00 í™˜ìVC D.3
@08/11/2025    6:30 í™˜ì203 D.2/5(5)
@08/11/2025    7:10 í™˜ìE B(C).4/10(5)
@08/09/2025    10:30 í™˜ìKC D(H).5/10(17)
@08/09/2025    11:30 í™˜ì201 C(D).4/10(4)
@08/09/2025    12:30 í™˜ìVC D.2
@08/09/2025    1:00 í™˜ì208B C.11
@08/08/2025    11:30 í™˜ìH C.1/10(32)
@08/08/2025    1:20 í™˜ìVC D.1
@08/08/2025    3:30 í™˜ì209 C.3/10(4)
@08/08/2025    6:00 í™˜ì210B C.1
@08/07/2025    11:00 í™˜ì201 C(D).3/10(3)
@08/07/2025    11:50 í™˜ìH C.V
@08/07/2025    1:00 í™˜ì203 D.1/5(4)
@08/07/2025    5:30 í™˜ì211 C.10/10(10)
@08/07/2025    6:30 í™˜ìJ D
@08/07/2025    7:10 í™˜ìE B(C).3/10(4)
@08/07/2025    8:00 í™˜ìLB A.2
@08/04/2025    11:00 í™˜ì201 C(D).2/10(2)
@08/04/2025    11:50 í™˜ìH C.10/10(31)
@08/04/2025    1:10 í™˜ì204B D(H).1
@08/04/2025    6:30 í™˜ì203 C(D).3
@08/02/2025    11:30 í™˜ì201 C.1/10(1)
@08/02/2025    12:30 í™˜ì206E C.4
@08/02/2025    1:00 í™˜ì207C C.3
@08/01/2025    12:00 í™˜ì212 D.1/10(2)
@08/01/2025    7:00 í™˜ìE B(C).2/10(3)
@07/31/2025    10:00 í™˜ì205 C(D).1/5(2)
@07/31/2025    11:45 í™˜ìH C.9/10(30)
@07/31/2025    1:00 í™˜ì203 C(D).1/10(2)
@07/31/2025    3:00 í™˜ì213D D.1
@07/31/2025    4:00 í™˜ìU D.37
@07/31/2025    5:10 í™˜ìAA C.10/10(10)
@07/31/2025    6:30 í™˜ìJ D.5/9(6)
@07/31/2025    7:00 í™˜ìKC D(H).4/10(16)
@07/28/2025    11:40 í™˜ìH C.8/10(29)
@07/28/2025    3:00 í™˜ì212 D.1
@07/28/2025    5:10 í™˜ìAA C.8/10(8)
@07/28/2025    6:30 í™˜ì203 C(D).2
@07/28/2025    7:10 í™˜ìE B(C).1/10(2)
@07/26/2025    12:30 í™˜ìKC D(H).3/10(15)
@07/26/2025    12:00 í™˜ì203 D.V
@07/26/2025    2:00 í™˜ì207C C.2
@07/25/2025    10:00 í™˜ì205 C(D).1
@07/25/2025    11:40 í™˜ìH C.7/10(28)
@07/25/2025    6:30 í™˜ìJ D.4/9(5)
@07/24/2025    11:40 í™˜ìH C.6/10(27)
@07/24/2025    4:00 í™˜ì214 D(H).10/10(3)
@07/24/2025    5:10 í™˜ìAA C.7/10(7)
@07/24/2025    7:30 í™˜ìE C.1
@07/21/2025    11:40 í™˜ìH C.5/10(26)
@07/21/2025    2:00 í™˜ì215E C(D).2
@07/21/2025    3:00 í™˜ì216D D.12
@07/21/2025    4:30 í™˜ìJ D.3/9(4)
@07/21/2025    5:30 í™˜ì217B C(D).4/10(4)
@07/21/2025    6:10 í™˜ì218 D.1
@07/21/2025    7:00 í™˜ìKC D(H).2/10(14)
@07/19/2025    10:00 í™˜ìKC D(H).1/10(13)
@07/19/2025    12:00 í™˜ìJ D.2/9(3)
@07/19/2025    1:30 í™˜ì206E C
@07/19/2025    2:00 í™˜ìU D.35
@07/18/2025    11:40 í™˜ìH C.4/10(25)
@07/18/2025    12:30 í™˜ìU D.35
@07/18/2025    2:30 í™˜ì219J D.2
@07/17/2025    11:40 í™˜ìH C.3/10(24)
@07/17/2025    5:10 í™˜ìAA C.4/10(4)
@07/17/2025    6:30 í™˜ìJ D.2
@07/17/2025    7:10 í™˜ì220 ì¶©ê²©íŒŒ15 .1
@07/12/2025    10:00 í™˜ìH C.2/10(22)
@07/12/2025    1:00 í™˜ìU D.34
@07/12/2025    2:00 í™˜ì215E C(D).1
@07/11/2025    11:40 í™˜ìH C.1/10(22)
@07/11/2025    3:45 í™˜ìA C.7/10(7)
@07/11/2025    5:10 í™˜ìAA C.2/10(2)
@07/10/2025    11:20 í™˜ì221 C.1
@07/10/2025    12:30 í™˜ì222 C.7
@07/10/2025    12:00 í™˜ì223D C.4
@07/10/2025    3:00 í™˜ì224 B.V
@07/10/2025    5:30 í™˜ìAA C.1
@07/07/2025    12:00 í™˜ì223D C.3
@07/07/2025    3:00 í™˜ì225C D.40
@07/05/2025    1:35 í™˜ì207C C.1
@07/04/2025    12:00 í™˜ì223D C.2
@07/04/2025    6:00 í™˜ì226B C.1
@06/30/2025    11:20 í™˜ì227 B(C).3
@06/30/2025    1:00 í™˜ì228K D.3
@06/30/2025    2:00 í™˜ì229 C.10
@06/30/2025    4:00 í™˜ì230G C.1
@06/30/2025    5:30 í™˜ìQ D.2
@06/27/2025    12:10 í™˜ì223D C.1
@06/27/2025    6:30 í™˜ì228K D.2
@06/27/2025    6:00 í™˜ì231 D.5/8(7)`;

        // ë°ì´í„° íŒŒì‹± í•¨ìˆ˜
        function parseScheduleData(rawData) {
            const lines = rawData.trim().split('\n').filter(line => line.trim() && line.startsWith('@'));
            const appointments = [];
            const patientFirstVisit = {};

            lines.forEach(line => {
                const match = line.match(/^@(\d{2}\/\d{2}\/\d{4})\s+(\d{1,2}):?(\d{2})?\s+([^@]+?)(\s+(.+))?$/);
                if (match) {
                    const [, date, hour, minute = '00', patientInfo, , courseInfo = ''] = match;
                    const time = `${hour.padStart(2, '0')}:${minute}`;

                    // í™˜ìëª… ì¶”ì¶œ (ì²« ë²ˆì§¸ ë‹¨ì–´ë“¤ì„ í™˜ìëª…ìœ¼ë¡œ ê°„ì£¼)
                    const parts = patientInfo.trim().split(/\s+/);
                    let patientName = parts[0];

                    // ì½”ìŠ¤ ì •ë³´ íŒŒì‹±
                    let course = '';
                    let session = '';
                    let status = null;

                    if (courseInfo) {
                        if (courseInfo.includes('ì¶©ê²©íŒŒ')) {
                            course = 'ì¶©ê²©íŒŒ';
                            session = courseInfo;
                        } else {
                            // ì½”ìŠ¤ ì •ë³´ ì¶”ì¶œ
                            const courseMatch = courseInfo.match(/([A-H](?:\([A-H]\))?(?:\([A-H]\))?)[.\s]*(\d+(?:\/\d+)?(?:\(\d+\))?)?/);
                            if (courseMatch) {
                                course = courseMatch[1];
                                session = courseMatch[2] || '';
                            }
                        }

                        // ìƒíƒœ í™•ì¸
                        if (courseInfo.includes('ì·¨ì†Œ') || courseInfo.includes('(ì·¨ì†Œ)')) {
                            status = 'ì·¨ì†Œ';
                        } else if (courseInfo.includes('ë¯¸ë£¸') || courseInfo.includes('(ë¯¸ë£¸)')) {
                            status = 'ë¯¸ë£¸';
                        }
                    } else {
                        // í™˜ìëª…ì—ì„œ ì½”ìŠ¤ ì •ë³´ ì¶”ì¶œ
                        const nameMatch = patientInfo.match(/^([^\s]+)\s+([A-H](?:\([A-H]\))?[.\d\/\(\)]*)/);
                        if (nameMatch) {
                            patientName = nameMatch[1];
                            const courseStr = nameMatch[2];
                            const courseMatch = courseStr.match(/([A-H](?:\([A-H]\))?)[.\s]*(\d+(?:\/\d+)?(?:\(\d+\))?)?/);
                            if (courseMatch) {
                                course = courseMatch[1];
                                session = courseMatch[2] || '';
                            }
                        }
                    }

                    // í™˜ì ì²« ë‚´ì›ì¼ ì¶”ì 
                    if (!patientFirstVisit[patientName] || new Date(patientFirstVisit[patientName]) > new Date(date.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2'))) {
                        patientFirstVisit[patientName] = date;
                    }

                    appointments.push({
                        date,
                        time,
                        patient: patientName,
                        course,
                        session,
                        status,
                        fullInfo: line.trim()
                    });
                }
            });

            return { appointments, patientFirstVisit };
        }

        // ë°ì´í„° íŒŒì‹±
        const { appointments, patientFirstVisit } = parseScheduleData(rawData);

        // í™˜ìë³„ ì •ë ¬
        const patients = [...new Set(appointments.map(apt => apt.patient))].sort();

        // ë‚ ì§œë³„ ì •ë ¬
        const dates = [...new Set(appointments.map(apt => apt.date))]
            .sort((a, b) => new Date(a.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2')) - new Date(b.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2')));

        // ë§¤íŠ¸ë¦­ìŠ¤ ë°ì´í„° êµ¬ì„±
        const matrix = {};
        patients.forEach(patient => {
            matrix[patient] = {};
            dates.forEach(date => {
                const dayAppointments = appointments.filter(apt => apt.patient === patient && apt.date === date);
                if (dayAppointments.length > 0) {
                    matrix[patient][date] = dayAppointments[0]; // ì²« ë²ˆì§¸ ì˜ˆì•½ë§Œ í‘œì‹œ
                }
            });
        });

        // í†µê³„ ê³„ì‚°
        function updateStats() {
            document.getElementById('totalPatients').textContent = patients.length;
            document.getElementById('totalAppointments').textContent = appointments.length;
            document.getElementById('newPatients').textContent = Object.keys(patientFirstVisit).length;
            document.getElementById('dateRange').textContent = dates.length > 0 ?
                `${dates[0]} ~ ${dates[dates.length - 1]}` : '-';
        }

        // ì›”ë³„ í•„í„° ì˜µì…˜ ìƒì„±
        function populateMonthFilter() {
            const months = [...new Set(dates.map(date => date.substring(0, 5)))].sort();
            const monthFilter = document.getElementById('monthFilter');
            months.forEach(month => {
                const option = document.createElement('option');
                option.value = month;
                option.textContent = `2025ë…„ ${month.substring(3)}ì›”`;
                monthFilter.appendChild(option);
            });
        }

        // ë‚ ì§œ í—¤ë” ìƒì„±
        function createDateHeader(filteredDates = dates) {
            const dateRow = document.getElementById('dateRow');
            dateRow.innerHTML = '';

            filteredDates.forEach(date => {
                const dateCell = document.createElement('div');
                dateCell.className = 'date-cell';

                const dateObj = new Date(date.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2'));
                const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
                const dayName = dayNames[dateObj.getDay()];

                dateCell.innerHTML = `
                    <div class="date-main">${date.substring(0, 5)}</div>
                    <div class="date-sub">${dayName}</div>
                `;
                dateRow.appendChild(dateCell);
            });
        }

        // í™˜ì ëª©ë¡ ìƒì„±
        function createPatientList(filteredPatients = patients) {
            const patientList = document.getElementById('patientList');
            patientList.innerHTML = '';

            filteredPatients.forEach(patient => {
                const patientCell = document.createElement('div');
                patientCell.className = 'patient-cell';

                // ë°©ë¬¸ íšŸìˆ˜ ê³„ì‚°
                const visitCount = appointments.filter(apt => apt.patient === patient).length;
                const isNewPatient = patientFirstVisit[patient];
                const isFrequentPatient = visitCount >= 3;

                if (isNewPatient) {
                    patientCell.classList.add('new-patient');
                } else if (isFrequentPatient) {
                    patientCell.classList.add('frequent-patient');
                }

                patientCell.innerHTML = `
                    <div class="patient-name">${patient}</div>
                    ${isNewPatient ? `<div class="first-visit">${patientFirstVisit[patient]}</div>` : ''}
                `;

                patientList.appendChild(patientCell);
            });
        }

        // ë°ì´í„° ê·¸ë¦¬ë“œ ìƒì„±
        function createDataGrid(filteredPatients = patients, filteredDates = dates) {
            const dataGrid = document.getElementById('dataGrid');
            dataGrid.innerHTML = '';

            filteredPatients.forEach(patient => {
                const dataRow = document.createElement('div');
                dataRow.className = 'data-row';

                filteredDates.forEach(date => {
                    const dataCell = document.createElement('div');
                    dataCell.className = 'data-cell';

                    const appointment = matrix[patient] && matrix[patient][date];

                    if (appointment) {
                        dataCell.classList.add('has-appointment');

                        // ì²« ë‚´ì› ì²´í¬
                        if (patientFirstVisit[patient] === date) {
                            dataCell.classList.add('new-patient-visit');
                        }

                        // ìƒíƒœ ì²´í¬
                        if (appointment.status === 'ì·¨ì†Œ') {
                            dataCell.classList.add('cancelled');
                        } else if (appointment.status === 'ë¯¸ë£¸') {
                            dataCell.classList.add('deferred');
                        }

                        // ì½”ìŠ¤ë³„ ìƒ‰ìƒ
                        if (appointment.course) {
                            const courseCode = appointment.course.charAt(0);
                            dataCell.classList.add(`course-${courseCode}`);
                        }

                        dataCell.innerHTML = `
                            ${appointment.status ? `<div class="status-badge status-${appointment.status === 'ì·¨ì†Œ' ? 'cancel' : 'defer'}">${appointment.status}</div>` : ''}
                            ${patientFirstVisit[patient] === date ? '<div class="new-badge">ì‹ í™˜</div>' : ''}
                            <div class="appointment-time">${appointment.time}</div>
                            <div class="appointment-course">${appointment.course}</div>
                            ${appointment.session ? `<div class="appointment-session">${appointment.session}</div>` : ''}
                        `;

                        dataCell.title = `${patient}\n${date} ${appointment.time}\n${appointment.course} ${appointment.session}\n${appointment.status || ''}`;
                    }

                    dataRow.appendChild(dataCell);
                });

                dataGrid.appendChild(dataRow);
            });
        }

        // ìŠ¤í¬ë¡¤ ë™ê¸°í™”
        function setupScrollSync() {
            const dateHeader = document.getElementById('dateHeader');
            const dataArea = document.getElementById('dataArea');
            const patientList = document.getElementById('patientList');

            // ê°€ë¡œ ìŠ¤í¬ë¡¤ ë™ê¸°í™”
            dateHeader.addEventListener('scroll', () => {
                dataArea.scrollLeft = dateHeader.scrollLeft;
            });

            dataArea.addEventListener('scroll', () => {
                dateHeader.scrollLeft = dataArea.scrollLeft;
                patientList.scrollTop = dataArea.scrollTop;
            });

            // ì„¸ë¡œ ìŠ¤í¬ë¡¤ ë™ê¸°í™”
            patientList.addEventListener('scroll', () => {
                dataArea.scrollTop = patientList.scrollTop;
            });
        }

        // í•„í„°ë§ í•¨ìˆ˜
        function applyFilters() {
            const monthFilter = document.getElementById('monthFilter').value;
            const patientSearch = document.getElementById('patientSearch').value.toLowerCase();
            const courseFilter = document.getElementById('courseFilter').value;
            const showNewOnly = document.getElementById('showNewOnly').checked;

            // ë‚ ì§œ í•„í„°ë§
            let filteredDates = dates;
            if (monthFilter) {
                filteredDates = dates.filter(date => date.startsWith(monthFilter));
            }

            // í™˜ì í•„í„°ë§
            let filteredPatients = patients;
            if (patientSearch) {
                filteredPatients = filteredPatients.filter(patient =>
                    patient.toLowerCase().includes(patientSearch)
                );
            }
            if (courseFilter) {
                filteredPatients = filteredPatients.filter(patient =>
                    appointments.some(apt =>
                        apt.patient === patient && apt.course.includes(courseFilter)
                    )
                );
            }
            if (showNewOnly) {
                filteredPatients = filteredPatients.filter(patient =>
                    patientFirstVisit[patient]
                );
            }

            // UI ì—…ë°ì´íŠ¸
            createDateHeader(filteredDates);
            createPatientList(filteredPatients);
            createDataGrid(filteredPatients, filteredDates);
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            document.getElementById('monthFilter').addEventListener('change', applyFilters);
            document.getElementById('patientSearch').addEventListener('input', applyFilters);
            document.getElementById('courseFilter').addEventListener('change', applyFilters);
            document.getElementById('showNewOnly').addEventListener('change', applyFilters);
        }

        // ì´ˆê¸°í™”
        function init() {
            updateStats();
            populateMonthFilter();
            createDateHeader();
            createPatientList();
            createDataGrid();
            setupScrollSync();
            setupEventListeners();
        }

        // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        document.addEventListener('keydown', (e) => {
            const dataArea = document.getElementById('dataArea');
            const scrollAmount = 200;

            switch(e.key) {
                case 'ArrowLeft':
                    dataArea.scrollLeft -= scrollAmount;
                    e.preventDefault();
                    break;
                case 'ArrowRight':
                    dataArea.scrollLeft += scrollAmount;
                    e.preventDefault();
                    break;
                case 'Home':
                    dataArea.scrollLeft = 0;
                    e.preventDefault();
                    break;
                case 'End':
                    dataArea.scrollLeft = dataArea.scrollWidth;
                    e.preventDefault();
                    break;
            }
        });

        // í˜ì´ì§€ ë¡œë”© ì™„ë£Œ í›„ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', init);

        console.log('âœ… í™˜ìë³„ ì¹˜ë£Œ ìŠ¤ì¼€ì¤„ ë§¤íŠ¸ë¦­ìŠ¤ ë¡œë”© ì™„ë£Œ!');
        console.log('ğŸ“Š ì´ í™˜ì:', patients.length, 'ëª…');
        console.log('ğŸ“… ì´ ì˜ˆì•½:', appointments.length, 'ê±´');
        console.log('ğŸ® ì¢Œìš° í™”ì‚´í‘œ: ê°€ë¡œ ìŠ¤í¬ë¡¤ | í•„í„°: ì›”ë³„/í™˜ì/ì½”ìŠ¤');
    </script>
</body>
</html>