<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìã ÌôòÏûêÎ≥Ñ ÏπòÎ£å Ïä§ÏºÄÏ§Ñ Îß§Ìä∏Î¶≠Ïä§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            font-size: 14px;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-number {
            font-size: 20px;
            font-weight: bold;
        }

        .controls {
            background: white;
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .filter-select, .filter-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .container {
            height: calc(100vh - 140px);
            position: relative;
            overflow: hidden;
            background: white;
        }

        /* Í≥†Ï†ï Ìó§Îçî ÏòÅÏó≠ */
        .patient-header {
            position: absolute;
            top: 0;
            left: 0;
            width: 180px;
            height: 60px;
            background: #495057;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            z-index: 20;
            border-right: 2px solid #333;
            border-bottom: 2px solid #333;
        }

        /* ÎÇ†Ïßú Ìó§Îçî (Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§) */
        .date-header {
            position: absolute;
            top: 0;
            left: 180px;
            right: 0;
            height: 60px;
            background: #e9ecef;
            border-bottom: 2px solid #333;
            overflow-x: auto;
            overflow-y: hidden;
            z-index: 15;
        }

        .date-row {
            display: flex;
            height: 60px;
            min-width: fit-content;
        }

        .date-cell {
            width: 120px;
            min-width: 120px;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #e9ecef;
            font-weight: bold;
            font-size: 11px;
            padding: 5px;
        }

        .date-main {
            font-size: 12px;
            font-weight: bold;
            color: #333;
        }

        .date-sub {
            font-size: 10px;
            color: #666;
            margin-top: 2px;
        }

        /* ÌôòÏûê Î™©Î°ù (ÏÑ∏Î°ú Ïä§ÌÅ¨Î°§) */
        .patient-list {
            position: absolute;
            top: 60px;
            left: 0;
            width: 180px;
            bottom: 0;
            background: #f8f9fa;
            border-right: 2px solid #333;
            overflow-x: hidden;
            overflow-y: auto;
            z-index: 15;
        }

        .patient-cell {
            height: 50px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 12px;
            background: #f8f9fa;
            font-size: 13px;
            font-weight: 600;
            color: #495057;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .patient-cell:hover {
            background: #e9ecef;
        }

        .patient-cell.new-patient {
            border-left: 4px solid #28a745;
            background: #f8fff9;
        }

        .patient-cell.frequent-patient {
            border-left: 4px solid #ffc107;
            background: #fffcf5;
        }

        .patient-name {
            flex: 1;
        }

        .first-visit {
            font-size: 9px;
            color: #28a745;
            margin-left: 5px;
        }

        /* Îç∞Ïù¥ÌÑ∞ ÏòÅÏó≠ (Ïä§ÌÅ¨Î°§ Í∞ÄÎä•) */
        .data-area {
            position: absolute;
            top: 60px;
            left: 180px;
            right: 0;
            bottom: 0;
            overflow: auto;
            z-index: 10;
        }

        .data-grid {
            min-width: fit-content;
        }

        .data-row {
            display: flex;
            height: 50px;
            border-bottom: 1px solid #ddd;
        }

        .data-cell {
            width: 120px;
            min-width: 120px;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            position: relative;
            padding: 4px;
            background: white;
            transition: all 0.2s;
        }

        .data-cell:hover {
            background: #f8f9fa;
            transform: scale(1.02);
            z-index: 5;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .data-cell.has-appointment {
            background: #e3f2fd;
            border: 1px solid #2196f3;
        }

        .data-cell.new-patient-visit {
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }

        .data-cell.cancelled {
            background: #ffebee;
            border: 1px solid #f44336;
            opacity: 0.7;
        }

        .data-cell.deferred {
            background: #fff3e0;
            border: 1px solid #ff9800;
            opacity: 0.8;
        }

        .appointment-time {
            font-weight: bold;
            font-size: 11px;
            color: #333;
        }

        .appointment-course {
            font-size: 9px;
            color: #666;
            margin-top: 2px;
        }

        .appointment-session {
            font-size: 8px;
            color: #999;
        }

        /* ÏΩîÏä§Î≥Ñ ÏÉâÏÉÅ */
        .course-A { border-left: 4px solid #e91e63; }
        .course-B { border-left: 4px solid #2196f3; }
        .course-C { border-left: 4px solid #4caf50; }
        .course-D { border-left: 4px solid #ff9800; }
        .course-H { border-left: 4px solid #9c27b0; }

        .status-badge {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 7px;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
        }

        .status-cancel {
            background: #f44336;
            color: white;
        }

        .status-defer {
            background: #ff9800;
            color: white;
        }

        .new-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 7px;
            background: #4caf50;
            color: white;
            padding: 1px 2px;
            border-radius: 2px;
        }

        /* Î≤îÎ°Ä */
        .legend {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 11px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-height: 400px;
            overflow-y: auto;
            width: 220px;
        }

        .legend h4 {
            margin: 0 0 8px 0;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 4px 0;
        }

        .legend-color {
            width: 16px;
            height: 12px;
            margin-right: 8px;
            border-radius: 2px;
        }

        /* Ïä§ÌÅ¨Î°§Î∞î Ïä§ÌÉÄÏùº */
        .date-header::-webkit-scrollbar,
        .data-area::-webkit-scrollbar,
        .patient-list::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .date-header::-webkit-scrollbar-track,
        .data-area::-webkit-scrollbar-track,
        .patient-list::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .date-header::-webkit-scrollbar-thumb,
        .data-area::-webkit-scrollbar-thumb,
        .patient-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .date-header::-webkit-scrollbar-thumb:hover,
        .data-area::-webkit-scrollbar-thumb:hover,
        .patient-list::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .patient-header, .patient-list { width: 120px; }
            .date-header, .data-area { left: 120px; }
            .date-cell, .data-cell { width: 100px; min-width: 100px; }
            .controls { flex-direction: column; }
            .legend { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìã ÌôòÏûêÎ≥Ñ ÏπòÎ£å Ïä§ÏºÄÏ§Ñ Îß§Ìä∏Î¶≠Ïä§</h1>
        <p>Í∞ÄÎ°ú Î¨¥Ìïú Ïä§ÌÅ¨Î°§ ‚Ä¢ ÏõîÎ≥Ñ ÌïÑÌÑ∞ ‚Ä¢ Ïã†Ìôò Ï∂îÏ†Å</p>
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalPatients">0</div>
                <div>Ï¥ù ÌôòÏûê</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalAppointments">0</div>
                <div>Ï¥ù ÏòàÏïΩ</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="newPatients">0</div>
                <div>Ïã†Ìôò</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="dateRange">-</div>
                <div>Í∏∞Í∞Ñ</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <div class="filter-group">
            <label>ÏõîÎ≥Ñ ÌïÑÌÑ∞:</label>
            <select id="monthFilter" class="filter-select">
                <option value="">Ï†ÑÏ≤¥ Ïõî</option>
            </select>

            <label>ÌôòÏûê Í≤ÄÏÉâ:</label>
            <input type="text" id="patientSearch" class="filter-input" placeholder="ÌôòÏûêÎ™Ö ÏûÖÎ†•...">

            <label>ÏΩîÏä§ ÌïÑÌÑ∞:</label>
            <select id="courseFilter" class="filter-select">
                <option value="">Ï†ÑÏ≤¥ ÏΩîÏä§</option>
                <option value="A">A ÏΩîÏä§</option>
                <option value="B">B ÏΩîÏä§</option>
                <option value="C">C ÏΩîÏä§</option>
                <option value="D">D ÏΩîÏä§</option>
                <option value="H">H ÏΩîÏä§</option>
            </select>
        </div>

        <div class="filter-group">
            <label>
                <input type="checkbox" id="showNewOnly"> Ïã†ÌôòÎßå Î≥¥Í∏∞
            </label>
        </div>
    </div>

    <div class="container">
        <!-- Í≥†Ï†ï Ìó§Îçî (ÌôòÏûêÎ™Ö) -->
        <div class="patient-header">
            <div>ÌôòÏûêÎ™Ö</div>
        </div>

        <!-- ÎÇ†Ïßú Ìó§Îçî (Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§) -->
        <div class="date-header" id="dateHeader">
            <div class="date-row" id="dateRow">
                <!-- JavaScriptÎ°ú ÏÉùÏÑ± -->
            </div>
        </div>

        <!-- ÌôòÏûê Î™©Î°ù (ÏÑ∏Î°ú Ïä§ÌÅ¨Î°§) -->
        <div class="patient-list" id="patientList">
            <!-- JavaScriptÎ°ú ÏÉùÏÑ± -->
        </div>

        <!-- Îç∞Ïù¥ÌÑ∞ ÏòÅÏó≠ (ÏñëÎ∞©Ìñ• Ïä§ÌÅ¨Î°§) -->
        <div class="data-area" id="dataArea">
            <div class="data-grid" id="dataGrid">
                <!-- JavaScriptÎ°ú ÏÉùÏÑ± -->
            </div>
        </div>
    </div>

    <!-- Î≤îÎ°Ä -->
    <div class="legend">
        <h4>üìä ÌëúÏãú Î∞©Î≤ï</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #e8f5e8; border: 1px solid #4caf50;"></div>
            Ïã†Ìôò (Ï≤´ ÎÇ¥Ïõê)
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #e3f2fd; border: 1px solid #2196f3;"></div>
            ÏùºÎ∞ò ÏòàÏïΩ
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ffebee; border: 1px solid #f44336;"></div>
            Ï∑®ÏÜåÎêú ÏòàÏïΩ
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #fff3e0; border: 1px solid #ff9800;"></div>
            ÎØ∏Î§ÑÏßÑ ÏòàÏïΩ
        </div>

        <h4>üé® ÏΩîÏä§Î≥Ñ ÏÉâÏÉÅ</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #e91e63;"></div>
            A ÏΩîÏä§
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #2196f3;"></div>
            B ÏΩîÏä§
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #4caf50;"></div>
            C ÏΩîÏä§
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ff9800;"></div>
            D ÏΩîÏä§
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #9c27b0;"></div>
            H ÏΩîÏä§
        </div>

        <h4>üë§ ÌôòÏûê Íµ¨Î∂Ñ</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #f8fff9; border-left: 4px solid #28a745;"></div>
            Ïã†Ìôò
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #fffcf5; border-left: 4px solid #ffc107;"></div>
            Îã§Ìöå Î∞©Î¨∏ (3Ìöå+)
        </div>
    </div>

    <script>
        // ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞Î•º ÌååÏã±ÌïòÏó¨ Íµ¨Ï°∞Ìôî
        const rawData = `
@09/22/2025    10:30 ÌôòÏûêDX C.5
@09/22/2025    11:00 ÌôòÏûêSC C(D).4/10(4)
@09/22/2025    4:00 ÌôòÏûêWB C(D).5/5(8)
@09/22/2025    5:30 ÌôòÏûêGC
@09/22/2025    6:30 ÌôòÏûêKC D(H).1/10(23)
@09/22/2025    7:30 ÌôòÏûêB C.4/10(4)
@09/22/2025    12:00 ÌôòÏûêRB D.
@09/20/2025    10:00 ÌôòÏûêLB A.6
@09/19/2025    12:00 ÌôòÏûêO A.25
@09/19/2025    4:00 ÌôòÏûêWB C(D).5/5(8)
@09/19/2025    6:30 ÌôòÏûêCB C.40
@09/18/2025    11:00 ÌôòÏûêRB D3/10(4)
@09/18/2025    12:00 ÌôòÏûêB C.5/10(5)
@09/18/2025    4:00 ÌôòÏûêWB C(D).4/5(7)
@09/18/2025    4:40 ÌôòÏûêNB A.6
@09/18/2025    5:30 ÌôòÏûêQ D.6
@09/18/2025    7:00 ÌôòÏûêF D.1
@09/15/2025    10:40 ÌôòÏûêSC C(D).3/10(3)
@09/15/2025    12:00 ÌôòÏûêVC C(D).1/10(17)
@09/15/2025    1:00 ÌôòÏûêO A.24
@09/15/2025    4:00 ÌôòÏûêWB C(D).3/5(6)
@09/15/2025    6:30 ÌôòÏûêB C.4/10(4)
@09/15/2025    6:40 ÌôòÏûêKC D(H).10/10(22)
@09/13/2025    9:00 ÌôòÏûêH C.9/10(40)
@09/13/2025    10:00 ÌôòÏûêKC D(H).9/10(21)
@09/13/2025    11:00 ÌôòÏûêLB A.5
@09/13/2025    11:30 ÌôòÏûêRB D.3
@09/13/2025    12:30 ÌôòÏûêO A.23
@09/13/2025    1:00 ÌôòÏûêCB C.38
@09/12/2025    11:30 ÌôòÏûêH C.8/10(39)
@09/12/2025    4:10 ÌôòÏûêRB D.2
@09/12/2025    6:00 ÌôòÏûêO A.22
@09/12/2025    7:00 ÌôòÏûêPD D.2
@09/11/2025    10:00 ÌôòÏûêVC C.15
@09/11/2025    11:00 ÌôòÏûêB C.3/10(3)
@09/11/2025    11:40 ÌôòÏûêH C.7/10(38)
@09/11/2025    6:30 ÌôòÏûêJ D.11
@09/11/2025    7:30 ÌôòÏûêPD C.1
@09/08/2025    12:00 ÌôòÏûêMB Ï∂©Í≤©Ìåå15.1
@09/08/2025    6:00 ÌôòÏûêB C.2/10(2)
@09/08/2025    7:20 ÌôòÏûêIB C.1
@09/06/2025    10:00 ÌôòÏûêA C.8/10(8)
@09/06/2025    1:00 ÌôòÏûêVC D.13
@09/05/2025    10:00 ÌôòÏûêDX C.4
@09/05/2025    11:30 ÌôòÏûêB C.1/10(1)
@09/04/2025    2:00 ÌôòÏûêRB D.1
@09/04/2025    3:00 ÌôòÏûêWB C(D).2/5(5)
@09/04/2025    4:00 ÌôòÏûêX D.30
@09/04/2025    4:30 ÌôòÏûêJ D.V
@09/04/2025    7:00 ÌôòÏûêT C.4
@09/01/2025    10:30 ÌôòÏûêDX C.3
@09/01/2025    11:30 ÌôòÏûêH C.6/10(37)
@09/01/2025    12:30 ÌôòÏûêVC D.12
@09/01/2025    3:00 ÌôòÏûêWB B(C).4
@09/01/2025    7:00 ÌôòÏûêE B(C).6/10(7)
@09/01/2025    7:30 ÌôòÏûêU D.41
@08/30/2025    10:00 ÌôòÏûêLB A.4
@08/30/2025    10:00 ÌôòÏûêH C.5/10(36)
@08/30/2025    11:00 ÌôòÏûêKC D(H).7/10(19)
@08/30/2025    12:00 ÌôòÏûê201 C(D).10/10(10)
@08/30/2025    1:00 ÌôòÏûê202 D.4
@08/30/2025    2:30 ÌôòÏûêVC D.11
@08/29/2025    10:30 ÌôòÏûêDX C.2
@08/29/2025    12:00 ÌôòÏûêVC D.10
@08/29/2025    4:35 ÌôòÏûêNB A.5
@08/28/2025    12:30 ÌôòÏûê203 D.5/7(8)
@08/28/2025    3:00 ÌôòÏûêWB B(C).3
@08/28/2025    6:30 ÌôòÏûêJ D.9/9(10)
@08/25/2025    10:00 ÌôòÏûê201 C(D).9/10(9)
@08/25/2025    11:00 ÌôòÏûêDX C(D).1
@08/25/2025    1:00 ÌôòÏûê204B D(H).3/5(4)
@08/25/2025    3:00 ÌôòÏûêWB A(B).2
@08/25/2025    7:00 ÌôòÏûêE B(C).5/10(6)
@08/23/2025    9:00 ÌôòÏûêH C.4/10(35)
@08/23/2025    10:00 ÌôòÏûêLB A.3
@08/23/2025    12:00 ÌôòÏûê202 D.3
@08/23/2025    14:00 ÌôòÏûêVC D.10
@08/23/2025    2:20 ÌôòÏûêKC D(H).6/10(18)
@08/22/2025    10:40 ÌôòÏûêX D.29
@08/22/2025    12:00 ÌôòÏûêH C.3/10(34)
@08/22/2025    2:00 ÌôòÏûê232I C.1
@08/22/2025    4:40 ÌôòÏûêC C.33
@08/22/2025    4:40 ÌôòÏûêNB A.4
@08/22/2025    18:30 ÏõêÏû•Îãò B(C)
@08/21/2025    10:30 ÌôòÏûêVC D.8
@08/21/2025    11:30 ÌôòÏûê201 C(D).8/10(8)
@08/21/2025    2:30 ÌôòÏûêWB A(B).1
@08/21/2025    6:30 ÌôòÏûêJ D.8/9(9)
@08/18/2025    11:20 ÌôòÏûê201 C(D).7/10(7)
@08/18/2025    1:00 ÌôòÏûêJ D.7/9(8)
@08/18/2025    1:50 ÌôòÏûê204B D(H).2/5(3)
@08/18/2025    3:00 ÌôòÏûêVC D.7
@08/18/2025    6:30 ÌôòÏûê203 D.4/7(7)
@08/16/2025    12:00 ÌôòÏûê202 D.2
@08/16/2025    1:00 ÌôòÏûêVC D.6
@08/15/2025    10:00 ÌôòÏûê202 D.1
@08/15/2025    11:10 ÌôòÏûêVC D.5
@08/14/2025    9:30 ÌôòÏûê205 C(D).2/5(3)
@08/14/2025    11:00 ÌôòÏûê201 C(D).6/10(6)
@08/14/2025    12:00 ÌôòÏûêH C.2/10(33)
@08/14/2025    2:00 ÌôòÏûêVC D.4
@08/14/2025    3:00 ÌôòÏûêU D.39
@08/14/2025    6:30 ÌôòÏûê203 D.3/5(6)
@08/11/2025    12:00 ÌôòÏûê204B D(H).1/5(2)
@08/11/2025    1:00 ÌôòÏûê201 C(D).5/10(5)
@08/11/2025    3:00 ÌôòÏûêVC D.3
@08/11/2025    6:30 ÌôòÏûê203 D.2/5(5)
@08/11/2025    7:10 ÌôòÏûêE B(C).4/10(5)
@08/09/2025    10:30 ÌôòÏûêKC D(H).5/10(17)
@08/09/2025    11:30 ÌôòÏûê201 C(D).4/10(4)
@08/09/2025    12:30 ÌôòÏûêVC D.2
@08/09/2025    1:00 ÌôòÏûê208B C.11
@08/08/2025    11:30 ÌôòÏûêH C.1/10(32)
@08/08/2025    1:20 ÌôòÏûêVC D.1
@08/08/2025    3:30 ÌôòÏûê209 C.3/10(4)
@08/08/2025    6:00 ÌôòÏûê210B C.1
@08/07/2025    11:00 ÌôòÏûê201 C(D).3/10(3)
@08/07/2025    11:50 ÌôòÏûêH C.V
@08/07/2025    1:00 ÌôòÏûê203 D.1/5(4)
@08/07/2025    5:30 ÌôòÏûê211 C.10/10(10)
@08/07/2025    6:30 ÌôòÏûêJ D
@08/07/2025    7:10 ÌôòÏûêE B(C).3/10(4)
@08/07/2025    8:00 ÌôòÏûêLB A.2
@08/04/2025    11:00 ÌôòÏûê201 C(D).2/10(2)
@08/04/2025    11:50 ÌôòÏûêH C.10/10(31)
@08/04/2025    1:10 ÌôòÏûê204B D(H).1
@08/04/2025    6:30 ÌôòÏûê203 C(D).3
@08/02/2025    11:30 ÌôòÏûê201 C.1/10(1)
@08/02/2025    12:30 ÌôòÏûê206E C.4
@08/02/2025    1:00 ÌôòÏûê207C C.3
@08/01/2025    12:00 ÌôòÏûê212 D.1/10(2)
@08/01/2025    7:00 ÌôòÏûêE B(C).2/10(3)
@07/31/2025    10:00 ÌôòÏûê205 C(D).1/5(2)
@07/31/2025    11:45 ÌôòÏûêH C.9/10(30)
@07/31/2025    1:00 ÌôòÏûê203 C(D).1/10(2)
@07/31/2025    3:00 ÌôòÏûê213D D.1
@07/31/2025    4:00 ÌôòÏûêU D.37
@07/31/2025    5:10 ÌôòÏûêAA C.10/10(10)
@07/31/2025    6:30 ÌôòÏûêJ D.5/9(6)
@07/31/2025    7:00 ÌôòÏûêKC D(H).4/10(16)
@07/28/2025    11:40 ÌôòÏûêH C.8/10(29)
@07/28/2025    3:00 ÌôòÏûê212 D.1
@07/28/2025    5:10 ÌôòÏûêAA C.8/10(8)
@07/28/2025    6:30 ÌôòÏûê203 C(D).2
@07/28/2025    7:10 ÌôòÏûêE B(C).1/10(2)
@07/26/2025    12:30 ÌôòÏûêKC D(H).3/10(15)
@07/26/2025    12:00 ÌôòÏûê203 D.V
@07/26/2025    2:00 ÌôòÏûê207C C.2
@07/25/2025    10:00 ÌôòÏûê205 C(D).1
@07/25/2025    11:40 ÌôòÏûêH C.7/10(28)
@07/25/2025    6:30 ÌôòÏûêJ D.4/9(5)
@07/24/2025    11:40 ÌôòÏûêH C.6/10(27)
@07/24/2025    4:00 ÌôòÏûê214 D(H).10/10(3)
@07/24/2025    5:10 ÌôòÏûêAA C.7/10(7)
@07/24/2025    7:30 ÌôòÏûêE C.1
@07/21/2025    11:40 ÌôòÏûêH C.5/10(26)
@07/21/2025    2:00 ÌôòÏûê215E C(D).2
@07/21/2025    3:00 ÌôòÏûê216D D.12
@07/21/2025    4:30 ÌôòÏûêJ D.3/9(4)
@07/21/2025    5:30 ÌôòÏûê217B C(D).4/10(4)
@07/21/2025    6:10 ÌôòÏûê218 D.1
@07/21/2025    7:00 ÌôòÏûêKC D(H).2/10(14)
@07/19/2025    10:00 ÌôòÏûêKC D(H).1/10(13)
@07/19/2025    12:00 ÌôòÏûêJ D.2/9(3)
@07/19/2025    1:30 ÌôòÏûê206E C
@07/19/2025    2:00 ÌôòÏûêU D.35
@07/18/2025    11:40 ÌôòÏûêH C.4/10(25)
@07/18/2025    12:30 ÌôòÏûêU D.35
@07/18/2025    2:30 ÌôòÏûê219J D.2
@07/17/2025    11:40 ÌôòÏûêH C.3/10(24)
@07/17/2025    5:10 ÌôòÏûêAA C.4/10(4)
@07/17/2025    6:30 ÌôòÏûêJ D.2
@07/17/2025    7:10 ÌôòÏûê220 Ï∂©Í≤©Ìåå15 .1
@07/12/2025    10:00 ÌôòÏûêH C.2/10(22)
@07/12/2025    1:00 ÌôòÏûêU D.34
@07/12/2025    2:00 ÌôòÏûê215E C(D).1
@07/11/2025    11:40 ÌôòÏûêH C.1/10(22)
@07/11/2025    3:45 ÌôòÏûêA C.7/10(7)
@07/11/2025    5:10 ÌôòÏûêAA C.2/10(2)
@07/10/2025    11:20 ÌôòÏûê221 C.1
@07/10/2025    12:30 ÌôòÏûê222 C.7
@07/10/2025    12:00 ÌôòÏûê223D C.4
@07/10/2025    3:00 ÌôòÏûê224 B.V
@07/10/2025    5:30 ÌôòÏûêAA C.1
@07/07/2025    12:00 ÌôòÏûê223D C.3
@07/07/2025    3:00 ÌôòÏûê225C D.40
@07/05/2025    1:35 ÌôòÏûê207C C.1
@07/04/2025    12:00 ÌôòÏûê223D C.2
@07/04/2025    6:00 ÌôòÏûê226B C.1
@06/30/2025    11:20 ÌôòÏûê227 B(C).3
@06/30/2025    1:00 ÌôòÏûê228K D.3
@06/30/2025    2:00 ÌôòÏûê229 C.10
@06/30/2025    4:00 ÌôòÏûê230G C.1
@06/30/2025    5:30 ÌôòÏûêQ D.2
@06/27/2025    12:10 ÌôòÏûê223D C.1
@06/27/2025    6:30 ÌôòÏûê228K D.2
@06/27/2025    6:00 ÌôòÏûê231 D.5/8(7)`;

        // Îç∞Ïù¥ÌÑ∞ ÌååÏã± Ìï®Ïàò
        function parseScheduleData(rawData) {
            const lines = rawData.trim().split('\n').filter(line => line.trim() && line.startsWith('@'));
            const appointments = [];
            const patientFirstVisit = {};

            lines.forEach(line => {
                const match = line.match(/^@(\d{2}\/\d{2}\/\d{4})\s+(\d{1,2}):?(\d{2})?\s+([^@]+?)(\s+(.+))?$/);
                if (match) {
                    const [, date, hour, minute = '00', patientInfo, , courseInfo = ''] = match;
                    const time = `${hour.padStart(2, '0')}:${minute}`;

                    // ÌôòÏûêÎ™Ö Ï∂îÏ∂ú (Ï≤´ Î≤àÏß∏ Îã®Ïñ¥Îì§ÏùÑ ÌôòÏûêÎ™ÖÏúºÎ°ú Í∞ÑÏ£º)
                    const parts = patientInfo.trim().split(/\s+/);
                    let patientName = parts[0];

                    // ÏΩîÏä§ Ï†ïÎ≥¥ ÌååÏã±
                    let course = '';
                    let session = '';
                    let status = null;

                    if (courseInfo) {
                        if (courseInfo.includes('Ï∂©Í≤©Ìåå')) {
                            course = 'Ï∂©Í≤©Ìåå';
                            session = courseInfo;
                        } else {
                            // ÏΩîÏä§ Ï†ïÎ≥¥ Ï∂îÏ∂ú
                            const courseMatch = courseInfo.match(/([A-H](?:\([A-H]\))?(?:\([A-H]\))?)[.\s]*(\d+(?:\/\d+)?(?:\(\d+\))?)?/);
                            if (courseMatch) {
                                course = courseMatch[1];
                                session = courseMatch[2] || '';
                            }
                        }

                        // ÏÉÅÌÉú ÌôïÏù∏
                        if (courseInfo.includes('Ï∑®ÏÜå') || courseInfo.includes('(Ï∑®ÏÜå)')) {
                            status = 'Ï∑®ÏÜå';
                        } else if (courseInfo.includes('ÎØ∏Î£∏') || courseInfo.includes('(ÎØ∏Î£∏)')) {
                            status = 'ÎØ∏Î£∏';
                        }
                    } else {
                        // ÌôòÏûêÎ™ÖÏóêÏÑú ÏΩîÏä§ Ï†ïÎ≥¥ Ï∂îÏ∂ú
                        const nameMatch = patientInfo.match(/^([^\s]+)\s+([A-H](?:\([A-H]\))?[.\d\/\(\)]*)/);
                        if (nameMatch) {
                            patientName = nameMatch[1];
                            const courseStr = nameMatch[2];
                            const courseMatch = courseStr.match(/([A-H](?:\([A-H]\))?)[.\s]*(\d+(?:\/\d+)?(?:\(\d+\))?)?/);
                            if (courseMatch) {
                                course = courseMatch[1];
                                session = courseMatch[2] || '';
                            }
                        }
                    }

                    // ÌôòÏûê Ï≤´ ÎÇ¥ÏõêÏùº Ï∂îÏ†Å
                    if (!patientFirstVisit[patientName] || new Date(patientFirstVisit[patientName]) > new Date(date.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2'))) {
                        patientFirstVisit[patientName] = date;
                    }

                    appointments.push({
                        date,
                        time,
                        patient: patientName,
                        course,
                        session,
                        status,
                        fullInfo: line.trim()
                    });
                }
            });

            return { appointments, patientFirstVisit };
        }

        // Îç∞Ïù¥ÌÑ∞ ÌååÏã±
        const { appointments, patientFirstVisit } = parseScheduleData(rawData);

        // ÌôòÏûêÎ≥Ñ Ï†ïÎ†¨
        const patients = [...new Set(appointments.map(apt => apt.patient))].sort();

        // ÎÇ†ÏßúÎ≥Ñ Ï†ïÎ†¨
        const dates = [...new Set(appointments.map(apt => apt.date))]
            .sort((a, b) => new Date(a.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2')) - new Date(b.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2')));

        // Îß§Ìä∏Î¶≠Ïä§ Îç∞Ïù¥ÌÑ∞ Íµ¨ÏÑ±
        const matrix = {};
        patients.forEach(patient => {
            matrix[patient] = {};
            dates.forEach(date => {
                const dayAppointments = appointments.filter(apt => apt.patient === patient && apt.date === date);
                if (dayAppointments.length > 0) {
                    matrix[patient][date] = dayAppointments[0]; // Ï≤´ Î≤àÏß∏ ÏòàÏïΩÎßå ÌëúÏãú
                }
            });
        });

        // ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
        function updateStats() {
            document.getElementById('totalPatients').textContent = patients.length;
            document.getElementById('totalAppointments').textContent = appointments.length;
            document.getElementById('newPatients').textContent = Object.keys(patientFirstVisit).length;
            document.getElementById('dateRange').textContent = dates.length > 0 ?
                `${dates[0]} ~ ${dates[dates.length - 1]}` : '-';
        }

        // ÏõîÎ≥Ñ ÌïÑÌÑ∞ ÏòµÏÖò ÏÉùÏÑ±
        function populateMonthFilter() {
            const months = [...new Set(dates.map(date => date.substring(0, 5)))].sort();
            const monthFilter = document.getElementById('monthFilter');
            months.forEach(month => {
                const option = document.createElement('option');
                option.value = month;
                option.textContent = `2025ÎÖÑ ${month.substring(3)}Ïõî`;
                monthFilter.appendChild(option);
            });
        }

        // ÎÇ†Ïßú Ìó§Îçî ÏÉùÏÑ±
        function createDateHeader(filteredDates = dates) {
            const dateRow = document.getElementById('dateRow');
            dateRow.innerHTML = '';

            filteredDates.forEach(date => {
                const dateCell = document.createElement('div');
                dateCell.className = 'date-cell';

                const dateObj = new Date(date.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$1-$2'));
                const dayNames = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
                const dayName = dayNames[dateObj.getDay()];

                dateCell.innerHTML = `
                    <div class="date-main">${date.substring(0, 5)}</div>
                    <div class="date-sub">${dayName}</div>
                `;
                dateRow.appendChild(dateCell);
            });
        }

        // ÌôòÏûê Î™©Î°ù ÏÉùÏÑ±
        function createPatientList(filteredPatients = patients) {
            const patientList = document.getElementById('patientList');
            patientList.innerHTML = '';

            filteredPatients.forEach(patient => {
                const patientCell = document.createElement('div');
                patientCell.className = 'patient-cell';

                // Î∞©Î¨∏ ÌöüÏàò Í≥ÑÏÇ∞
                const visitCount = appointments.filter(apt => apt.patient === patient).length;
                const isNewPatient = patientFirstVisit[patient];
                const isFrequentPatient = visitCount >= 3;

                if (isNewPatient) {
                    patientCell.classList.add('new-patient');
                } else if (isFrequentPatient) {
                    patientCell.classList.add('frequent-patient');
                }

                patientCell.innerHTML = `
                    <div class="patient-name">${patient}</div>
                    ${isNewPatient ? `<div class="first-visit">${patientFirstVisit[patient]}</div>` : ''}
                `;

                patientList.appendChild(patientCell);
            });
        }

        // Îç∞Ïù¥ÌÑ∞ Í∑∏Î¶¨Îìú ÏÉùÏÑ±
        function createDataGrid(filteredPatients = patients, filteredDates = dates) {
            const dataGrid = document.getElementById('dataGrid');
            dataGrid.innerHTML = '';

            filteredPatients.forEach(patient => {
                const dataRow = document.createElement('div');
                dataRow.className = 'data-row';

                filteredDates.forEach(date => {
                    const dataCell = document.createElement('div');
                    dataCell.className = 'data-cell';

                    const appointment = matrix[patient] && matrix[patient][date];

                    if (appointment) {
                        dataCell.classList.add('has-appointment');

                        // Ï≤´ ÎÇ¥Ïõê Ï≤¥ÌÅ¨
                        if (patientFirstVisit[patient] === date) {
                            dataCell.classList.add('new-patient-visit');
                        }

                        // ÏÉÅÌÉú Ï≤¥ÌÅ¨
                        if (appointment.status === 'Ï∑®ÏÜå') {
                            dataCell.classList.add('cancelled');
                        } else if (appointment.status === 'ÎØ∏Î£∏') {
                            dataCell.classList.add('deferred');
                        }

                        // ÏΩîÏä§Î≥Ñ ÏÉâÏÉÅ
                        if (appointment.course) {
                            const courseCode = appointment.course.charAt(0);
                            dataCell.classList.add(`course-${courseCode}`);
                        }

                        dataCell.innerHTML = `
                            ${appointment.status ? `<div class="status-badge status-${appointment.status === 'Ï∑®ÏÜå' ? 'cancel' : 'defer'}">${appointment.status}</div>` : ''}
                            ${patientFirstVisit[patient] === date ? '<div class="new-badge">Ïã†Ìôò</div>' : ''}
                            <div class="appointment-time">${appointment.time}</div>
                            <div class="appointment-course">${appointment.course}</div>
                            ${appointment.session ? `<div class="appointment-session">${appointment.session}</div>` : ''}
                        `;

                        dataCell.title = `${patient}\n${date} ${appointment.time}\n${appointment.course} ${appointment.session}\n${appointment.status || ''}`;
                    }

                    dataRow.appendChild(dataCell);
                });

                dataGrid.appendChild(dataRow);
            });
        }

        // Ïä§ÌÅ¨Î°§ ÎèôÍ∏∞Ìôî
        function setupScrollSync() {
            const dateHeader = document.getElementById('dateHeader');
            const dataArea = document.getElementById('dataArea');
            const patientList = document.getElementById('patientList');

            // Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§ ÎèôÍ∏∞Ìôî
            dateHeader.addEventListener('scroll', () => {
                dataArea.scrollLeft = dateHeader.scrollLeft;
            });

            dataArea.addEventListener('scroll', () => {
                dateHeader.scrollLeft = dataArea.scrollLeft;
                patientList.scrollTop = dataArea.scrollTop;
            });

            // ÏÑ∏Î°ú Ïä§ÌÅ¨Î°§ ÎèôÍ∏∞Ìôî
            patientList.addEventListener('scroll', () => {
                dataArea.scrollTop = patientList.scrollTop;
            });
        }

        // ÌïÑÌÑ∞ÎßÅ Ìï®Ïàò
        function applyFilters() {
            const monthFilter = document.getElementById('monthFilter').value;
            const patientSearch = document.getElementById('patientSearch').value.toLowerCase();
            const courseFilter = document.getElementById('courseFilter').value;
            const showNewOnly = document.getElementById('showNewOnly').checked;

            // ÎÇ†Ïßú ÌïÑÌÑ∞ÎßÅ
            let filteredDates = dates;
            if (monthFilter) {
                filteredDates = dates.filter(date => date.startsWith(monthFilter));
            }

            // ÌôòÏûê ÌïÑÌÑ∞ÎßÅ
            let filteredPatients = patients;
            if (patientSearch) {
                filteredPatients = filteredPatients.filter(patient =>
                    patient.toLowerCase().includes(patientSearch)
                );
            }
            if (courseFilter) {
                filteredPatients = filteredPatients.filter(patient =>
                    appointments.some(apt =>
                        apt.patient === patient && apt.course.includes(courseFilter)
                    )
                );
            }
            if (showNewOnly) {
                filteredPatients = filteredPatients.filter(patient =>
                    patientFirstVisit[patient]
                );
            }

            // UI ÏóÖÎç∞Ïù¥Ìä∏
            createDateHeader(filteredDates);
            createPatientList(filteredPatients);
            createDataGrid(filteredPatients, filteredDates);
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        function setupEventListeners() {
            document.getElementById('monthFilter').addEventListener('change', applyFilters);
            document.getElementById('patientSearch').addEventListener('input', applyFilters);
            document.getElementById('courseFilter').addEventListener('change', applyFilters);
            document.getElementById('showNewOnly').addEventListener('change', applyFilters);
        }

        // Ï¥àÍ∏∞Ìôî
        function init() {
            updateStats();
            populateMonthFilter();
            createDateHeader();
            createPatientList();
            createDataGrid();
            setupScrollSync();
            setupEventListeners();
        }

        // ÌÇ§Î≥¥Îìú ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò
        document.addEventListener('keydown', (e) => {
            const dataArea = document.getElementById('dataArea');
            const scrollAmount = 200;

            switch(e.key) {
                case 'ArrowLeft':
                    dataArea.scrollLeft -= scrollAmount;
                    e.preventDefault();
                    break;
                case 'ArrowRight':
                    dataArea.scrollLeft += scrollAmount;
                    e.preventDefault();
                    break;
                case 'Home':
                    dataArea.scrollLeft = 0;
                    e.preventDefault();
                    break;
                case 'End':
                    dataArea.scrollLeft = dataArea.scrollWidth;
                    e.preventDefault();
                    break;
            }
        });

        // ÌéòÏù¥ÏßÄ Î°úÎî© ÏôÑÎ£å ÌõÑ Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', init);

        console.log('‚úÖ ÌôòÏûêÎ≥Ñ ÏπòÎ£å Ïä§ÏºÄÏ§Ñ Îß§Ìä∏Î¶≠Ïä§ Î°úÎî© ÏôÑÎ£å!');
        console.log('üìä Ï¥ù ÌôòÏûê:', patients.length, 'Î™Ö');
        console.log('üìÖ Ï¥ù ÏòàÏïΩ:', appointments.length, 'Í±¥');
        console.log('üéÆ Ï¢åÏö∞ ÌôîÏÇ¥Ìëú: Í∞ÄÎ°ú Ïä§ÌÅ¨Î°§ | ÌïÑÌÑ∞: ÏõîÎ≥Ñ/ÌôòÏûê/ÏΩîÏä§');
    </script>
</body>
</html>